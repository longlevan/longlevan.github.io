<!DOCTYPE html>
<html>
    <!--This is a comment. Head style-->
    <head>
            <title>longlevan's page</title>
            <style>
                ul {
                    list-style-type: none;
                    margin: 0;
                    padding: 0; 
                    overflow: hidden;
                    border: 1px solid #e7e7e7;
                    background-color: #f3f3f3;
                }
                
                li {
                    float: left;		
                }
                li a{
                    display: block;
                    color: #666;
                    text-align: center;
                    padding: 14px 16px;
                    text-decoration: none;
                }
                li a:hover:not(.active) {
                    background-color: #ddd;
                }
                li a.active{
                    color:white;
                    background-color: #4CAF50;
                }
        
                .dropdown{
                    float: left;
                    overflow: hidden;
                }
                .dropdown.dropbtn{
                    font-size: 16px;
                    border: none;
                    outline: none;
                    color: white;
                    padding: 14 px 16 px;
                    background-color: inherit;
                }
                .dropdown-content {
                    display: none;
                    position: absolute;
                    background-color: #f9f9f9;
                    min-width: 160px;
                    box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.2);
                    z-index: 1;
                }
                .dropdown-content a{
                    float: none;
                    color: black;
                    padding: 12px 16px;
                    text-decoration: none;
                    display: block;
                    text-align: left;
                }
                .dropdown-content a:hover {
                    background-color: #ddd;
                }
                .dropdown:hover .dropdown-content {
                    display: block;
                }
                </style>
        <script type="text/javascript" async
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML">
      </script>
            </head>
        
<body>
    <!--Naviation bar-->
            <ul>
              <li><a href="../index.html"><font size="6">Home</font></a></li>
              <li><a href="blog.html"><font size="6">Blog</font></a></li>
        
              <div class="dropdown">
                  
                  <div class="dropbtn"><font size="6">How-Tos</font>
                      <i class="fa fa-caret-down"></i>
                  </div>

                  <div class ="dropdown-content">
                      <a href="trnsys.html">Trnsys</a>
                  </div>
              </div>	
        
              <li><a href="https://longlevan.weebly.com/about-me.html" target="_blank"><font size="6">About</font></a></li>
            </ul>	
            

  <h1>Glossary</h1>
  <a href="https://en.wikipedia.org/wiki/Mean_radiant_temperature">Mean radiant temperature</a>: is defined as the uniform temperature of an imaginary enclosure
  in which the radiant heat transfer from the human body is equal to the radiant heat transfer in the actual non-uniform enclosure <br>

  <a href="https://en.wikipedia.org/wiki/Mean_radiant_temperature">Mean radiant temperature</a>: is defined as the uniform temperature of an imaginary enclosure
  in which the radiant heat transfer from the human body is equal to the radiant heat transfer in the actual non-uniform enclosure <br>

  - The solar <a href="https://en.wikipedia.org/wiki/Zenith"> zenith</a> angle is the angle between the zenith and the centre of the Sun's disc.<br>
    The zenith is an imaginary point directly "above" a particular location, on the<br>

<h1>Tools</h1>
<a href="http://view3d.sourceforge.net/"><b>View3D</b></a>
<p>View3D is a command-line tool for evaluating radiation view factors for scenes with complex 2D and 3D geometry. It uses an adaptive integration method to calculate the view factors between faces where there is partial obstruction from inbetween faces. </p>

<h1>Creating TRNSYS component c/c++ header file</h1>
TRNSYS has one more input / output distinction; that is DERIVATIVES. Components that solve
differential equations numerically will often have DERIVATIVES as well as INPUTS, OUTPUTS
and PARAMETERS. From the simulation user’s point of view, the DERIVATIVES for a given
Type specify initial values, such as the initial temperatures of various nodes in a thermal storage
tank or the initial zone temperatures in a multi zone building. At any given point in time, the
DERIVATIVES of a Type hold the results of the solved differential equation. If these
DERIVATIVES are set in a component as OUTPUTS, the simulation user can see, plot and
output these values. <br>
<br>
<h2>Rereading Parameters</h2>
If two or more instances of a given Type are to be used in a simulation, it is necessary to reread
the parameter values so that the local variables within the Type’s code reflect the values
associated with the current instance. <br>

<h2>Fundamentals</h2>
Inputs: 
Parameters:
Outputs: All outputs are assumed to be time dependent and are recomputed by a component
Derivatives: Components that solve
differential equations numerically will often have DERIVATIVES as well as INPUTS, OUTPUTS
and PARAMETERS. From the simulation user’s point of view, the DERIVATIVES for a given
Type specify initial values, such as the initial temperatures of various nodes in a thermal storage
tank or the initial zone temperatures in a multi zone building. At any given point in time, the
DERIVATIVES of a Type hold the results of the solved differential equation. If these
DERIVATIVES are set in a component as OUTPUTS, the simulation user can see, plot and
output these values.

<h3>Version Signing</h3>
Version signing is one of a series of special calls that is made to a Type when the Type is not
intended to perform any manipulations of inputs or outputs. Once, at the very beginning of a
simulation, a Type needs to log itself as having been written using a given TRNSYS coding
standard.

<h3>"Last Call" Manipulations</h3>
The second special case call to Types occurs at the very END of each simulation. Whether the
simulation ends correctly or ends in error, each Type is recalled by the TRNSYS kernel before the
simulation shuts down. This call allows Types to perform any “last call” manipulations that may be
necessary. These may include closing external data files that were opened by the Type during
the course of a simulation, or calculating summary information that may have been collected
during a simulation. If the type does not require any such last call manipulation, so it is advisable 
to simply return control directly to the Trnsys kernel.
<br>
You may want your component to actually do something at the end of the simulation. It could, for
instance print a message to the list file or close logical units that were used during the simulation.
Standard component Type 22 (Iterative Feedback controller) performs end of the simulation
manipulations that you might use as an example.
<br>

<h3>"End of Time Step" manipulations</h3>
At the end of each time step, each Type in a simulation is recalled. The Type should call the
AccessFunction “getIsEndOfTimestep().” Note that the function will return “true” even if a
converged solution was not found at the current time step. 
<br>

the “end of time step” call allows a number of different manipulations to be performed such as resetting 
counters. For users familiar with the concept of manually updating storage variables, the concept of “dynamic” 
and “static” storage variables were introduced with TRNSYS 17. Refer to section 7.4.4.17

<h3>Storage of Data between Time Steps</h3>
With the release of TRNSYS v.17, the concept of data storage between time steps was further
simplified into two main usages: “static” and “dynamic.” If the user has a component that was
written using an earlier coding standard, both the “s array” and the set/getStorageVars() functions
are retained in the kernel so that the component does not need to be modified. However, if the
user is writing a component using the TRNSYS v.17 coding standard, the user should not make
use of these earlier features as they are incompatible with the more recent standard.
<h4>Static storage</h4>


<h4>Dynamic storage</h4>

<br>
<h1>Creating a Dynamic-Link Library using MS Visual Studio</h1>
Opent MS Visual Studio <br>
File\New\Project <br>

Installed\Visual C++\ Dynamic-Link Library (DLL) <br>

Name: Name of dll project <br>
Location: The location of source code <br>
Solution: Create new solution <br>
Solution name: <br>
<br>
Step 2: Configuration properties <br>
Configuration: Active (Debug) Platform x64
General: let it as default
- Target Platform: Windows 10
- Windows SDK Version: 10.0.16299.0
- Output Directory: $(SolutionDir)

Debugging: let it as default

VC++ Directories: let it as default

C/C++
general: 
- Additional Include Directories: adding trnsys.h location
- Optimization: do nothing
- Preprocessor: Verify if all is in majuscule
- Code generation: 
- All Options: adding  trnsys.h location to Additional Include Directories

/Yu"stdafx.h" /GS /W3 /Zc:wchar_t /ZI /Gm /Od /sdl /Fd"x64\Debug\vc141.pdb" /Zc:inline /fp:precise /D "_DEBUG" /D "TRNSYSCOMPONENTSLIBX64_EXPORTS" /D "_WINDOWS" /D "_USRDLL" /D "_WINDLL" /D "_UNICODE" /D "UNICODE" /errorReport:prompt /WX- /Zc:forScope /RTC1 /Gd /MDd /Fa"x64\Debug\" /EHsc /nologo /Fo"x64\Debug\" /Fp"x64\Debug\TRNSYSComponentsLib_x64.pch" /diagnostics:classic 

Linker
General
- Additional Library directories: 
Input
- Additional Dependencies


What is the difference betwwen Release and Debug

Visual Studio fatal error C1041/FS
<code>fatal error C1041: cannot open program database 'c:\users\username\desktop\projectName\projectName\x64\debug\vc120.pdb'; if multiple CL.EXE write to the same .PDB file, please use /FS</code>

The problem is because different projects in a solution hat the same intermediate directory
changin
<code>$(Platform)\$(Configuration)\ to $(Platform)\$(Configuration)\$(ProjectName)\</code>
in 
configuration properties->general->Intermediate directory


Use "View > Other Windows > Property Manager" to bring up the Property Manager. It will show your projects and configurations.

Right click a configuration, and select "Add New Project Property Sheet...". You can name it, and select a location that works for all your projects.

Once created, you can edit its properties just as you would a build configuration.

To use that property sheet as the basis for other projects, just right click the configuration or project, and select "Add Existing Property Sheet...". Browse to where you saved the original sheet, and it will be inherited.
Any changes to the original sheet will be applied to any project that inherits it, unless they are overridden. If you go into properties higher up the chain, properties that override will have bold type for their values. To get them to always use the value in the base sheet, there will be a "inherit from parent or project defaults" option where applicable.

Programming a Type in C++


<br>





<!--###################################################################################-->
To get the name of the function of TRNSYS <br>
<i>source: exp </i> <br>

Get the name of the function of TRNSYS that is published. Function of TRNSYS is TRNDLL.DLL (C: TRNSYS17 \ Exe \ TRNDLL.DLL) to, 
but contains all the functions that have been published under a different name and when using in FORTRAN There are multiple. To call from the C / C ++, 
to get the name of the function directly from TRNDLL.DLL. Taken out of the function name is done with the development tools included in Visual Studio.

Run the following batch file from the command prompt, and prepares the use environment of development tools. Below is a working example of the PC 
that Visual Studio 2013 has been installed.

<code>"C: \ Program Files (X86) \ Microsoft Visual Studio 12.0 \ Common7 \ Tools \ Vsvars32.Bat"</code>
First, and prepares for using the development tools. Start the command prompt, type [Win] + in the dialog displayed by clicking the [R] "cmd" from the keyboard.

Then, using the dumpbin.exe 




<h1>System of differential equations</h1>
<p>
    Solving differential equations in a TRNSYS Type is an easy task <br>
    <b>Note:</b> <font color="red">TRNSYS uses <b>AVERAGED</b> values on the time step, NOT INSTANTANEOUS values. So if you compare results from TRNSYS to other programs or hand calculations, you often have to convert "end-of-time-step" values to averaged values.</font>
</p>
<ul>
    <li>Use the DTDT and T arrays</li>
    T and DTDT are managed by the TRNSYS solver and are 
   available to any TRNSYS Types. To use them, you have
   to specify a number of "DERIVATIVES" in the TRNSYS 
   deck. The principle is that you assign values to DTDT in
   your Type and the TRNSYS solver will give you the 
   result of the integration (T).t is a pure numerical
   solution so there is no restriction on the linearity.
   It is probably the easiest approach because you don't 
   have to store values at the end of a time step and get 
   them back at next time step, everything is done for you.
   <b> <font color="red">The downside is that you may have to use small time steps 
   to reach a stable solution in some cases.</font></bi>
   TRNSYS versions 11.1 and higher provide two methods for solving differential equations which
may occur in component models: an approximate analytical solution using the subroutine
SolveDiffEq (see Section 7.4.4.15), and a numerical solution using one of three numerical
methods (see Manual 06-TRNEdit). 
The analytical method is recommended whenever practical it
is possible to write the differential equation in the following general form:
$${dT \over dt} = aT +b$$
The numerical method generally requires shorter time steps and more computation for
comparable accuracy and numerical stability. Users intending to utilize the Powell’s method
TRNSYS solver (SOLVER 1) should use the SolveDiffEq subroutine whenever possible. 


</ul>
</body>
</html>